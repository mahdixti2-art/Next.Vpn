<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NextVPN | ุฎุฑุฏ ุงุดุชุฑุงฺฉ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@100;400;700;900&display=swap');
        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: #020617;
            color: #e2e8f0;
            user-select: none;
        }
        .animate-in {
            animation: fadeIn 0.4s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        input::placeholder {
            color: #475569;
            font-size: 0.8rem;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
            const [step, setStep] = useState(1);
            const [isAdmin, setIsAdmin] = useState(false);
            const [adminPass, setAdminPass] = useState('');
            const [showAdminLogin, setShowAdminLogin] = useState(false);

            const [months, setMonths] = useState(1);
            const [volume, setVolume] = useState(10);
            const [contact, setContact] = useState('');
            const [contactError, setContactError] = useState(false); // ูุถุนุช ุฎุทุง ุจุฑุง ููุฏ ุชูุงุณ
            const [receiptImage, setReceiptImage] = useState(null);
            const [previewUrl, setPreviewUrl] = useState(null);
            const [loading, setLoading] = useState(false);
            const [isSuccess, setIsSuccess] = useState(false);

            const [config, setConfig] = useState({
                basePrice: 30000,
                perGbPrice: 5000,
                cardNumber: "6219861908913584",
                cardName: "ููุญู ูุฎุชุงุฑ",
                supportUrl: "https://t.me/Mahdi4F"
            });

            const BOT_TOKEN = "8302811186:AAEMBp9XhMGiW4WaBNF-F59BeDGa_gHV1To";
            const CHAT_ID = "8474397291";

            const totalPrice = (months * config.basePrice) + (volume * config.perGbPrice);

            const handleImageChange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    setReceiptImage(file);
                    setPreviewUrl(URL.createObjectURL(file));
                }
            };

            const copyToClipboard = () => {
                const text = config.cardNumber;
                const el = document.createElement('textarea');
                el.value = text;
                document.body.appendChild(el);
                el.select();
                document.execCommand('copy');
                document.body.removeChild(el);
                
                const toast = document.createElement('div');
                toast.innerText = "ุดูุงุฑู ฺฉุงุฑุช ฺฉูพ ุดุฏ!";
                toast.className = "fixed bottom-10 left-1/2 -translate-x-1/2 bg-sky-600 text-white px-6 py-2 rounded-full text-xs font-bold z-[100] animate-bounce";
                document.body.appendChild(toast);
                setTimeout(() => toast.remove(), 2000);
            };

            const handleSubmit = async () => {
                if (!receiptImage || !contact) return;
                setLoading(true);
                
                try {
                    const now = new Date().toLocaleString('fa-IR');
                    const caption = `๐ ุณูุงุฑุด ุฌุฏุฏ\n` +
                                    `โโโโโโโโโโโโโโ\n` +
                                    `๐ ูุฏุช: ${months} ูุงู\n` +
                                    `๐พ ุญุฌู: ${volume} ฺฏฺฏ\n` +
                                    `๐ฐ ูุจูุบ ูพุฑุฏุงุฎุช: ${totalPrice.toLocaleString()} ุชููุงู\n` +
                                    `๐ค ุขุฏ/ุดูุงุฑู: ${contact}\n` +
                                    `โโโโโโโโโโโโโโ\n` +
                                    `โฐ ุฒูุงู: ${now}`;
                    
                    const formData = new FormData();
                    formData.append('chat_id', CHAT_ID);
                    formData.append('caption', caption);
                    formData.append('photo', receiptImage);

                    const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
                        method: 'POST',
                        body: formData
                    });

                    if (response.ok) {
                        setIsSuccess(true);
                    } else {
                        alert("ุฎุทุง ุฏุฑ ุงุฑุณุงู ุฑุณุฏ. ูุทูุงู ุญุฌู ุนฺฉุณ ุฑุง ฺฉู ฺฉุฑุฏู ุง ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ.");
                    }
                } catch (error) {
                    alert("ุฎุทุง ุดุจฺฉู! ูุทูุงู ุงุชุตุงู ุงูุชุฑูุช ุฎูุฏ ุฑุง ฺฺฉ ฺฉูุฏ.");
                } finally {
                    setLoading(false);
                }
            };

            const handleNextStepTwo = () => {
                if (!contact || contact.trim().length < 3) {
                    setContactError(true);
                } else {
                    setContactError(false);
                    setStep(3);
                }
            };

            const resetAll = () => {
                setStep(1);
                setMonths(1);
                setVolume(10);
                setContact('');
                setContactError(false);
                setReceiptImage(null);
                setPreviewUrl(null);
                setIsSuccess(false);
            };

            if (isAdmin) return (
                <div className="min-h-screen p-6 animate-in flex flex-col items-center justify-start overflow-y-auto">
                    <div className="bg-slate-900 border border-sky-500/30 p-8 rounded-[2rem] max-w-lg w-full shadow-2xl my-10 text-right">
                        <h2 className="text-2xl font-bold text-white mb-6 text-center italic">ุชูุธูุงุช ูพูู ูุฏุฑุช</h2>
                        <div className="space-y-4">
                            <div className="grid grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-[10px] text-slate-500 mb-1 font-bold">ููุช ูพุงู (ุชููุงู)</label>
                                    <input type="number" value={config.basePrice} onChange={(e) => setConfig({...config, basePrice: parseInt(e.target.value) || 0})} className="w-full bg-slate-950 border border-slate-800 p-3 rounded-xl text-white text-center text-sm" />
                                </div>
                                <div>
                                    <label className="block text-[10px] text-slate-500 mb-1 font-bold">ููุช ูุฑ ฺฏฺฏ (ุชููุงู)</label>
                                    <input type="number" value={config.perGbPrice} onChange={(e) => setConfig({...config, perGbPrice: parseInt(e.target.value) || 0})} className="w-full bg-slate-950 border border-slate-800 p-3 rounded-xl text-white text-center text-sm" />
                                </div>
                            </div>
                            <div>
                                <label className="block text-[10px] text-slate-500 mb-1 font-bold">ุดูุงุฑู ฺฉุงุฑุช</label>
                                <input type="text" value={config.cardNumber} onChange={(e) => setConfig({...config, cardNumber: e.target.value})} className="w-full bg-slate-950 border border-slate-800 p-3 rounded-xl text-white text-center tracking-widest text-sm" />
                            </div>
                            <div>
                                <label className="block text-[10px] text-slate-500 mb-1 font-bold">ูุงู ุตุงุญุจ ฺฉุงุฑุช</label>
                                <input type="text" value={config.cardName} onChange={(e) => setConfig({...config, cardName: e.target.value})} className="w-full bg-slate-950 border border-slate-800 p-3 rounded-xl text-white text-center text-sm" />
                            </div>
                            <div>
                                <label className="block text-[10px] text-slate-500 mb-1 font-bold">ููฺฉ ูพุดุชุจุงู</label>
                                <input type="text" value={config.supportUrl} onChange={(e) => setConfig({...config, supportUrl: e.target.value})} className="w-full bg-slate-950 border border-slate-800 p-3 rounded-xl text-white text-center text-xs" style={{direction: 'ltr'}} />
                            </div>
                            <button onClick={() => setIsAdmin(false)} className="w-full bg-sky-600 py-4 rounded-xl font-bold text-white mt-4">ุฐุฎุฑู ู ุฎุฑูุฌ</button>
                        </div>
                    </div>
                </div>
            );

            if (isSuccess) return (
                <div className="min-h-screen flex items-center justify-center p-6 animate-in">
                    <div className="bg-slate-900 border border-emerald-500/30 p-10 rounded-[3rem] text-center max-w-sm w-full">
                        <div className="text-6xl mb-6">โ</div>
                        <h2 className="text-2xl font-bold text-white mb-4">ุงุฑุณุงู ุดุฏ!</h2>
                        <p className="text-slate-400 text-sm mb-8">ุฑุณุฏ ุดูุง ุฏุฑุงูุช ุดุฏ. ุงฺฉุงูุช ุดูุง ุจูโุฒูุฏ ุงุฑุณุงู ูโุดูุฏ.</p>
                        <button onClick={resetAll} className="w-full bg-slate-800 py-4 rounded-2xl font-bold">ุจุงุฒฺฏุดุช</button>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen p-4 relative overflow-x-hidden">
                    <div className="absolute top-0 left-0 w-16 h-16 opacity-0" onClick={() => setShowAdminLogin(true)}></div>
                    
                    <div className="max-w-xl mx-auto pt-10">
                        <header className="text-center mb-10">
                            <h1 className="text-4xl font-black text-white italic tracking-tighter uppercase">NEXT<span className="text-sky-500">VPN</span></h1>
                        </header>

                        <div className="bg-slate-900/50 border border-slate-800 rounded-[2.5rem] overflow-hidden backdrop-blur-xl shadow-2xl shadow-sky-500/5">
                            <div className="flex bg-slate-950/50 border-b border-slate-800 text-[10px] font-bold text-slate-500 uppercase tracking-widest">
                                <div className={`flex-1 py-4 text-center ${step === 1 ? 'text-sky-500 border-b-2 border-sky-500' : ''}`}>ฑ. ูพูู</div>
                                <div className={`flex-1 py-4 text-center ${step === 2 ? 'text-sky-500 border-b-2 border-sky-500' : ''}`}>ฒ. ุงุทูุงุนุงุช</div>
                                <div className={`flex-1 py-4 text-center ${step === 3 ? 'text-sky-500 border-b-2 border-sky-500' : ''}`}>ณ. ูพุฑุฏุงุฎุช</div>
                            </div>

                            <div className="p-8">
                                {step === 1 && (
                                    <div className="space-y-10 animate-in">
                                        <div className="space-y-6">
                                            <div className="flex justify-between items-center text-sm font-bold"><span className="text-slate-400">ูุฏุช ุงุนุชุจุงุฑ:</span><span className="text-white">{months} ูุงูู</span></div>
                                            <input type="range" min="1" max="12" value={months} onChange={(e)=>setMonths(parseInt(e.target.value))} className="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-sky-500" />
                                        </div>
                                        <div className="space-y-6">
                                            <div className="flex justify-between items-center text-sm font-bold"><span className="text-slate-400">ุญุฌู ุชุฑุงูฺฉ:</span><span className="text-white">{volume} ฺฏฺฏุงุจุงุช</span></div>
                                            <input type="range" min="5" max="200" step="5" value={volume} onChange={(e)=>setVolume(parseInt(e.target.value))} className="w-full h-2 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-sky-500" />
                                        </div>
                                        <div className="bg-slate-950 p-6 rounded-3xl border border-slate-800 flex justify-between items-center shadow-inner">
                                            <span className="text-slate-500 text-xs font-bold uppercase">ูุจูุบ ูุงุจู ูพุฑุฏุงุฎุช:</span>
                                            <span className="text-2xl font-black text-sky-500">{totalPrice.toLocaleString()} ุชููุงู</span>
                                        </div>
                                        <button onClick={()=>setStep(2)} className="w-full bg-sky-600 hover:bg-sky-500 py-5 rounded-2xl font-bold transition-all active:scale-[0.98]">ูุฑุญูู ุจุนุฏ</button>
                                    </div>
                                )}

                                {step === 2 && (
                                    <div className="space-y-8 animate-in text-right">
                                        <div className="space-y-4">
                                            <h3 className="text-xl font-bold text-white pr-2">ุงุทูุงุนุงุช ุชุญูู ุณุฑูุณ</h3>
                                            <div className="relative">
                                                <input 
                                                    type="text" 
                                                    value={contact} 
                                                    onChange={(e)=>{
                                                        setContact(e.target.value);
                                                        if(e.target.value.trim().length > 0) setContactError(false);
                                                    }} 
                                                    placeholder="ุขุฏ ุชูฺฏุฑุงู ุง ุดูุงุฑู ููุจุงู ุฌูุช ุงุฑุณุงู ุงฺฉุงูุช" 
                                                    className={`w-full bg-slate-950 border ${contactError ? 'border-red-500' : 'border-slate-800'} rounded-2xl p-5 text-right text-white outline-none focus:border-sky-500 transition-colors`} 
                                                />
                                                {contactError && (
                                                    <p className="text-red-500 text-[11px] font-bold mt-2 pr-2 animate-pulse">
                                                        โ๏ธ ูุงุฑุฏ ฺฉุฑุฏู ุขุฏ ุง ุดูุงุฑู ุชูุงุณ ุงุฌุจุงุฑุณุช
                                                    </p>
                                                )}
                                            </div>
                                            <p className="text-[10px] text-slate-500 leading-relaxed pr-2">
                                                * ุฏูุช ฺฉูุฏ ฺฉู ุขุฏ ุง ุดูุงุฑู ูุงุฑุฏ ุดุฏู ุจุงุฏ ุตุญุญ ุจุงุดุฏ ุชุง ููฺฉุงุฑุงู ูุง ุจุชูุงููุฏ ุงฺฉุงูุช ุฑุง ุจุฑุง ุดูุง ุงุฑุณุงู ฺฉููุฏ.
                                            </p>
                                        </div>
                                        <button 
                                            onClick={handleNextStepTwo} 
                                            className="w-full bg-sky-600 hover:bg-sky-500 py-5 rounded-2xl font-bold transition-all active:scale-[0.98]"
                                        >
                                            ุงุฏุงูู ุจู ูพุฑุฏุงุฎุช
                                        </button>
                                        <button onClick={()=>setStep(1)} className="w-full text-slate-500 text-sm font-bold">ุจุงุฒฺฏุดุช ู ุชุบุฑ ูพูู</button>
                                    </div>
                                )}

                                {step === 3 && (
                                    <div className="space-y-8 animate-in text-right">
                                        <div className="bg-slate-950 p-6 rounded-[2.5rem] border border-slate-800 text-center space-y-3 relative overflow-hidden">
                                            <div className="absolute -top-10 -right-10 w-32 h-32 bg-sky-500/10 blur-[50px]"></div>
                                            <div className="text-[10px] text-slate-500 uppercase font-bold tracking-widest">ูุจูุบ ููุง ุชุฑุงฺฉูุด</div>
                                            <div className="text-3xl font-black text-sky-500">{totalPrice.toLocaleString()} ุชููุงู</div>
                                            <div className="h-px bg-slate-800 w-full my-4"></div>
                                            <div className="text-[10px] text-slate-500 uppercase font-bold tracking-widest">ุดูุงุฑู ฺฉุงุฑุช ุฌูุช ูุงุฑุฒ</div>
                                            <div className="text-lg font-bold text-white tracking-widest">{config.cardNumber}</div>
                                            <div className="text-xs text-slate-400 font-bold">ุจู ูุงู: {config.cardName}</div>
                                            <button onClick={copyToClipboard} className="text-sky-500 text-xs font-bold underline decoration-sky-500/30 underline-offset-4 pt-2">ฺฉูพ ุดูุงุฑู ฺฉุงุฑุช</button>
                                        </div>

                                        <div className="space-y-4">
                                            <div className="flex items-start gap-2 pr-2">
                                                <span className="text-sky-500 mt-1">โ</span>
                                                <p className="text-[11px] text-slate-400 leading-relaxed">
                                                    ูพุณ ุงุฒ ูุงุฑุฒ ูุจูุบุ ุงุฒ ุตูุญู ุฑุณุฏ ุงุณฺฉุฑูโุดุงุช ุจฺฏุฑุฏ ู ุงุฒ ุจุฎุด ุฒุฑ ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏ.
                                                </p>
                                            </div>
                                            <div onClick={()=>document.getElementById('file-in').click()} className="border-2 border-dashed border-slate-800 rounded-3xl p-6 flex flex-col items-center justify-center cursor-pointer hover:bg-slate-800/20 min-h-[160px] transition-all group">
                                                {previewUrl ? (
                                                    <div className="relative group">
                                                        <img src={previewUrl} className="h-32 object-contain rounded-xl shadow-lg border border-slate-700" />
                                                        <div className="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 flex items-center justify-center rounded-xl transition-opacity text-[10px] font-bold">ุชุบุฑ ุชุตูุฑ</div>
                                                    </div>
                                                ) : (
                                                    <div className="text-center space-y-2">
                                                        <div className="text-3xl text-slate-700 group-hover:text-sky-500 transition-colors">๐</div>
                                                        <span className="text-slate-600 text-xs font-bold">ุงูุชุฎุงุจ ุชุตูุฑ ุฑุณุฏ ูพุฑุฏุงุฎุช</span>
                                                    </div>
                                                )}
                                                <input type="file" id="file-in" hidden accept="image/*" onChange={handleImageChange} />
                                            </div>
                                        </div>

                                        <div className="space-y-3">
                                            <button 
                                                disabled={loading || !receiptImage} 
                                                onClick={handleSubmit} 
                                                className={`w-full py-5 rounded-2xl font-black transition-all ${loading || !receiptImage ? 'bg-slate-800 text-slate-600 cursor-not-allowed' : 'bg-emerald-600 text-white hover:bg-emerald-500 shadow-xl shadow-emerald-900/20 active:scale-[0.98]'}`}
                                            >
                                                {loading ? (
                                                    <span className="flex items-center justify-center gap-2">
                                                        <svg className="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle><path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                                                        ุฏุฑ ุญุงู ุซุจุช ุณูุงุฑุด...
                                                    </span>
                                                ) : "ุชฺฉูู ู ุซุจุช ููุง"}
                                            </button>
                                            <button onClick={()=>setStep(2)} className="w-full text-slate-500 text-xs font-bold">ุจุงุฒฺฏุดุช ุจู ูุฑุญูู ูุจู</button>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>

                        <footer className="mt-10 text-center text-[10px] text-slate-600 font-bold uppercase tracking-widest space-y-2">
                            <p>ยฉ 2024 NEXTVPN SERVICE GROUP</p>
                            <a href={config.supportUrl} target="_blank" className="text-sky-500 block hover:underline">ุงุฑุชุจุงุท ุจุง ูพุดุชุจุงู ุชูฺฏุฑุงู</a>
                        </footer>
                    </div>

                    {showAdminLogin && (
                        <div className="fixed inset-0 bg-black/90 flex items-center justify-center z-[200] p-4 backdrop-blur-md animate-in">
                            <div className="bg-slate-900 p-8 rounded-[2rem] border border-slate-800 w-full max-w-xs shadow-2xl">
                                <h4 className="text-center text-white mb-6 font-bold italic">ADMIN ACCESS</h4>
                                <input 
                                    type="password" 
                                    placeholder="ฺฉููู ุนุจูุฑ" 
                                    value={adminPass} 
                                    onChange={(e) => setAdminPass(e.target.value)} 
                                    onKeyDown={(e) => { if(e.key === 'Enter') document.getElementById('admin-login-btn').click(); }}
                                    className="w-full bg-slate-950 border border-slate-800 p-4 rounded-xl mb-4 text-center text-white outline-none focus:border-sky-500" 
                                />
                                <div className="flex gap-2">
                                    <button 
                                        id="admin-login-btn"
                                        onClick={() => { 
                                            if(adminPass === 'mahdi1386'){ 
                                                setIsAdmin(true); 
                                                setShowAdminLogin(false); 
                                            } else { 
                                                alert('ุฑูุฒ ุนุจูุฑ ูุงุฏุฑุณุช ุงุณุช'); 
                                            } 
                                        }} 
                                        className="flex-1 bg-sky-600 py-3 rounded-xl font-bold"
                                    >ูุฑูุฏ</button>
                                    <button onClick={() => setShowAdminLogin(false)} className="flex-1 bg-slate-800 py-3 rounded-xl font-bold">ุงูุตุฑุงู</button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
